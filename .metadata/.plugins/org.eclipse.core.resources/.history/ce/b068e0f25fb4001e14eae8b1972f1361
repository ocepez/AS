package sportsDAO;

import java.sql.Connection;

import javax.persistence.EntityExistsException;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;

import donnees.Discipline;
import donnees.Sport;
import donnees.Sportif;

public class DAO_JPA_Sport extends DAO_JPA<Sport> {


	
    private Connection connection = null;
    private EntityManager em = null;
    private EntityTransaction trans = null;

	public DAO_JPA_Sport() throws DAOException {
		super();
        this.connection = SQLConnection.getConnection();
        getEntityManager();

	}
	
	public EntityManager getEntityManager() {
		if(em == null) {
		      EntityManagerFactory emf = Persistence.createEntityManagerFactory("SportsPU");
		      em = emf.createEntityManager();
		      
		}
		return em;
	}

	@Override
	public Sport find(int id) throws DAOException {
		trans = em.getTransaction();
        Sport sport =  em.find(Sport.class, id);
        return sport;
	}

	@Override
	public void create(Sport disc) throws DAOException {
		try {
			em.persist(disc);

		} catch(EntityExistsException e) {
			System.out.println("Element déjà créé");
		}
	
	}

	@Override
	public void update(Sport disc) throws DAOException {
			em.persist(disc);

		}

	@Override
	public void delete(Sport disc) throws DAOException {
		em.remove(disc);			
	}

}
